# Contributor: Rasmus Thomsen <oss@cogitri.dev>
# Maintainer: Rasmus Thomsen <oss@cogitri.dev>
pkgname=gxi
pkgver=0.8.1
pkgrel=0
pkgdesc="GTK frontend for the xi text editor, written in Rust"
url="https://github.com/Cogitri/gxi"
arch="x86_64" # limited by rust
license="MIT"
makedepends="meson cargo gettext-dev gtk+3.0-dev"
checkdepends="desktop-file-utils appstream-glib"
subpackages="$pkgname-lang"
source="https://github.com/Cogitri/gxi/releases/download/v${pkgver}/gxi-${pkgver}.tar.xz"

build() {
	# Use system gettext
	export GETTEXT_BIN_DIR=/usr/bin
	export GETTEXT_LIB_DIR=/usr/lib/gettext
	export GETTEXT_INCLUDE_DIR=/usr/include

	meson \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var \
		--buildtype=release \
		. output
	ninja -C output
}

check() {
	ninja -C output test
}

package() {
	DESTDIR="$pkgdir" ninja -C output install
}

sha512sums="78971d7eab9b35e3c1d41b4a2d8b435669849fe9931ee46d34d1fa8ae94edb5f1d68fb6755a8772f5c983c0eaaa87999db3a25a26b0163ab35b7c6090da9cd89  gxi-0.8.1.tar.xz"
